<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta name="description" content="A Better Way to Interact on App.Net">
        <meta name="viewport" content="width=device-width initial-scale=1.0 maximum-scale=1.0 user-scalable=yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="format-detection" content="telephone=no">
        <meta name="robots" content="index, follow">
        <meta http-equiv="cleartype" content="on">
        <meta charset="utf-8">

        <link type="text/css" rel="stylesheet" href="css/style.css" />
        <link type="text/css" rel="stylesheet" href="css/font-awesome.css" />
        <link type="text/css" rel="stylesheet" href="css/jquery.mmenu.all.css" />

        <link href="img/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="img/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76" />
        <link href="img/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120" />
        <link href="img/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152" />
        <link href="img/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180" />
        <link href="img/icon-hires.png" rel="icon" sizes="192x192" />
        <link href="img/icon-normal.png" rel="icon" sizes="128x128" />

        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/jquery.mmenu.min.all.js"></script>
        <script type="text/javascript">
            $(function() {
                $('nav#menu').mmenu({
                    extensions  : [ 'effect-slide', 'pageshadow' ],
                    header      : true,
                    searchfield : true,
                    counters    : false,
                    footer      : { add     : true,
                                    content : '<a href="https://app.net/">Join App.Net Today!</a>'
                                  }
                });
            });
        </script>
    </head>
    <body>
        <div id="page">
            <div class="header fixed">
                <a id="mnu-avatar" href="#menu"></a>
                <span id="hd-activity" class="hide"><i class="fa fa-refresh fa-spin"></i></span>
                <span id="hd-spacer" class="show">&nbsp;</span>
                <strong id="site-name">{Don&apos;t Forget To Set a Site Name}</strong>
                <button id="doAction">Sign In</button>
            </div>
            <nav id="menu">
                <ul>
                    <li><span>Streams</span>
                        <ul>
                            <li><span id="list-home" onClick="showHideTL('home');">Home</span></li>
                            <li><span id="list-mentions"onClick="showHideTL('mentions');">Mentions</span></li>
                            <li><span id="list-global" onClick="showHideTL('global');">Global</span></li>
                            <li><span id="list-pms" onClick="showHideTL('pms');">PMs</span></li>
                        </ul>
                    </li>
                    <li><span>Preferences</span>
                        <ul>
                            <li><span>General</span>
                                <ul>
                                    <li><span id="show_live" onclick="setLiveTimestamps();">Show Live Timestamps <i class="fa fa-check"></i></span></li>
                                    <li><span>Refresh Rate</span>
                                        <ul>
                                            <li><span id="ref-5" onclick="setRefreshInterval(5);">Every 5 Seconds</span></li>
                                            <li><span id="ref-15" onclick="setRefreshInterval(15);">Every 15 Seconds</span></li>
                                            <li><span id="ref-60" onclick="setRefreshInterval(60);">Every Minute</span></li>
                                            <li><span id="ref-10000" onclick="setRefreshInterval(10000);">Never (Manual)</span></li>
                                        </ul>
                                    </li>
                                    <li><span>Posts Per Column</span>
                                        <ul>
                                            <li><span id="ppc-50" onclick="setPostsPerColumn(50);">50 Posts</span></li>
                                            <li><span id="ppc-250" onclick="setPostsPerColumn(250);">250 Posts</span></li>
                                            <li><span id="ppc-500" onclick="setPostsPerColumn(500);">500 Posts</span></li>
                                            <li><span id="ppc-1000" onclick="setPostsPerColumn(1000);">1000 Posts</span></li>
                                            <li><span id="ppc-99999" onclick="setPostsPerColumn(99999);">Unlimited</span></li>
                                        </ul>
                                    </li>
                                    <li><span>Font Size</span>
                                        <ul>
                                            <li><span id="fs-12" onclick="setFontSize(12);">Smaller</span></li>
                                            <li><span id="fs-14" onclick="setFontSize(14);">Normal</span></li>
                                            <li><span id="fs-16" onclick="setFontSize(16);">Larger</span></li>
                                            <li><span id="fs-20" onclick="setFontSize(20);">Largest</span></li>
                                        </ul>
                                    </li>
                                    <li><span id="show_hideimg" onclick="setHideImages();">Don&apos;t Load Images</span></li>
                                </ul>
                            </li>
                            <li><span>Global Timeline</span>
                                <ul>
                                    <li><span>Show ...</span>
                                        <ul>
                                            <li><span id="gshow-e" onclick="setGlobalShow('e');">Everyone</span></li>
                                            <li><span id="gshow-n" onclick="setGlobalShow('n');">Only Accounts I Don&apos;t Follow</span></li>
                                        </ul>
                                    </li>
                                    <li><span>Include Website Feeds (Coming Soon)</span></li>
                                </ul>
                            </li>
                            <li><span>Language (Coming Soon)</span>
                                <ul>
                                    <li><span id="lang_de" onclick="switchLanguage('de');">Deutsch</span></li>
                                    <li><span id="lang_en" onclick="switchLanguage('en');">English <i class="fa fa-check"></i></span></li>
                                    <li><span id="lang_es" onclick="switchLanguage('es');">Español</span></li>
                                    <li><span id="lang_fr" onclick="switchLanguage('fr');">Français</span></li>
                                    <li><span id="lang_pr" onclick="switchLanguage('pr');">Português</span></li>
                                    <li><span id="lang_ru" onclick="switchLanguage('ru');">русский</span></li>
                                    <li><span id="lang_sv" onclick="switchLanguage('sv');">svenska</span></li>
                                    <li><span id="lang_ja" onclick="switchLanguage('ja');">日本語</span></li>
                                    <li><span id="lang_ko" onclick="switchLanguage('ko');">한국어</span></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li><span onClick="doLogout();">Logout</span></li>
                </ul>
            </nav>
            <div id="tl-content" class="content">
                <div id="tl-space" class="timelines"></div>
            </div>
            <div id="splash" class="dialog hide">
                <div class="progress">
                    <i class="fa fa-spinner fa-pulse"></i>
                    <span id="prog-msg">&nbsp;</span>
                </div>
            </div>
            <div id="response" class="dialog hide">
                <div class="reply">
                    <div class="entry">
                        <textarea id="rpy-text" class="mention"></textarea>
                    </div>
                    <div class="actions">
                        <span id="rpy-length">256</span>
                        <span id="rpy-draft" style="padding-left: 15px; font-size: 150%;" onclick="loadDraft();"></span>
                        <button id="rpy-kill" class="btn-red">Cancel</button>
                        <button id="rpy-send" class="btn-grey">Send</button>
                    </div>
                </div>
            </div>
            <div id="gallery" class="photo hide">
                <div class="close" onclick="showHideGallery();"></div>
                <div id="img-show" class="panel"></div>
            </div>
            <div id="conversation" class="dialog hide"></div>
            <div id="draftbox" class="dialog hide">
                <div class="msgbox">
                    <div class="title">Before You Go ...</div>
                    <div id="msg" class="message">Would you like to save this message as a draft?</div>
                    <div class="buttons">
                        <button onclick="showSaveDraft();" class="btn-red">No, Thanks</button>
                        <button onclick="saveDraft();" class="btn-green">Yes, Please</button>
                    </div>
                </div>
            </div>
            <div id="autocomp" class="dialog hide"></div>
            <div id="hashbox" class="dialog hide"></div>
            <div id="dialog" class="dialog hide"></div>
            <div id="okbox" class="dialog hide"></div>
        </div>
        <script type="text/javascript" src="js/dom.js"></script>
        <script type="text/javascript" src="js/core.js"></script>
        <script>
            jQuery(function($) {
                window.store = new Object();
                window.chans = {};
                window.posts = {};
                window.users = {};
                window.activate = false;
                window.is_private = false;
                window.timelines = { home     : false,
                                     mentions : false,
                                     global   : true,
                                     pms      : false
                }
                loadConfigFile();

                $('#doAction').click(function() { doPostOrAuth(); });
                $('#rpy-kill').click(function() { killPost(); });
                $('#rpy-send').click(function() { sendPost(); });
                $("#rpy-text").keyup(function() {
                    var caret = getCaretPos(this);
                    var result = /\S+$/.exec(this.value.slice(0, caret));
                    var lastWord = result ? result[0] : null;
                    if ( lastWord !== undefined && lastWord !== '' && lastWord !== null ) {
                        if ( lastWord.length >= 4 && lastWord.charAt(0) === '@' ) {
                            listNames( lastWord );
                        } else {
                            if( $('#autocomp').hasClass('show') ) { $('#autocomp').removeClass('show').addClass('hide'); }
                        }
                    }

                    doHandyTextSwitch();
                });
                $("#rpy-text").keydown(function (event) { if ( (event.metaKey || event.ctrlKey) && event.keyCode == 13 ) { sendPost(); } });
                $(document).keyup(function(e) {
                    if( $('#response').hasClass('hide') ) { if ( event.keyCode == 78 ) { showHideResponse(); } }
                    if ( event.keyCode == 113 ) { $('#autocomp').removeClass('show').addClass('hide'); }
                });
                $(document).keydown(function(e) { 
                    if ( (e.metaKey || e.ctrlKey) && e.keyCode == 75 ) { clearTimelines(); }
                    if (e.keyCode == 27) { killPost(); }
                });
                document.addEventListener('focusout', function(e) {window.scrollTo(0, 0)});
                $( window ).resize(function() { setWindowConstraints(); });
            });
            window.addEventListener('load', function(){
                var touchsurface = document.getElementById('rpy-text'),
                    startX,
                    startY,
                    dist,
                    threshold = 150,
                    allowedTime = 1000,
                    elapsedTime,
                    startTime;
                function handleswipe(isRightSwipe, isLeftSwipe) {
                    if ( isRightSwipe === true ) { setCursorPosition( 1 ); }
                    if ( isLeftSwipe === true ) { setCursorPosition( -1 ); }
                }
                function setCursorPosition( PlusMinus ) {
                    var txtBox = document.getElementById('rpy-text');
                    setCaretToPos(txtBox, txtBox.selectionEnd + PlusMinus);
                }
                touchsurface.addEventListener('touchstart', function(e){
                    touchsurface.innerHTML = '';
                    var touchobj = e.changedTouches[0];
                    dist = 0;
                    startX = touchobj.pageX;
                    startY = touchobj.pageY;
                    startTime = new Date().getTime();
                }, false);
                touchsurface.addEventListener('touchmove', function(e){ e.preventDefault(); }, false);
                touchsurface.addEventListener('touchend', function(e){
                    var touchobj = e.changedTouches[0];
                    dist_r = touchobj.pageX - startX;
                    dist_l = startX - touchobj.pageX;
                    elapsedTime = new Date().getTime() - startTime;
                    var isRightSwipe = (elapsedTime <= allowedTime && dist_r >= threshold && Math.abs(touchobj.pageY - startY) <= 100),
                        isLeftSwipe = (elapsedTime <= allowedTime && dist_l >= threshold && Math.abs(touchobj.pageY - startY) <= 100);
                    handleswipe(isRightSwipe, isLeftSwipe);
                    if ( isRightSwipe || isLeftSwipe ) { e.preventDefault(); }
                }, false); 
            }, false);
            function doMore( post_id ) {
                alert( "[Debug] Let's Show another Modal for Post: " + post_id );
            }
        </script>
    </body>
</html>